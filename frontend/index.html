<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Property Activity Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <style>
      .tab-content {
        display: none;
      }
      .tab-content.active {
        display: block;
      }
      .notification-badge {
        animation: pulse 2s infinite;
      }
      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }
      .activity-marker {
        border-radius: 50%;
        width: 12px;
        height: 12px;
        border: 2px solid white;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      }
      .activity-visit {
        background-color: #10b981;
      }
      .activity-call {
        background-color: #3b82f6;
      }
      .activity-inspection {
        background-color: #f59e0b;
      }
      .activity-follow-up {
        background-color: #8b5cf6;
      }
      .activity-note {
        background-color: #6b7280;
      }
    </style>
  </head>
  <body class="bg-gray-50 min-h-screen">
    <!-- Login Modal -->
    <div
      id="loginModal"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden"
      style="z-index: 9999;"
    >
      <div class="bg-white rounded-lg p-8 w-96 shadow-xl">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">
          Login to Property Tracker
        </h2>
        <form id="loginForm">
          <div class="mb-4">
            <label class="block text-gray-700 text-sm font-medium mb-2"
              >Sales Rep Name</label
            >
            <input
              type="text"
              id="salesRepName"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="Enter your name"
              required
            />
          </div>
          <button
            type="submit"
            class="w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition duration-200"
          >
            Login
          </button>
        </form>
      </div>
    </div>

    <!-- Header -->
    <header class="bg-white shadow-sm border-b border-gray-200">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
          <div class="flex items-center">
            <h1 class="text-xl font-semibold text-gray-900">
              Property Activity Tracker
            </h1>
          </div>

          <div class="flex items-center space-x-4">
            <!-- Notifications -->
            <button
              id="notificationBtn"
              class="relative p-2 text-gray-600 hover:text-gray-900 transition duration-200"
            >
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 17h5l-5 5v-5zM11 19H6a2 2 0 01-2-2V7a2 2 0 012-2h5m5 0v6m0 0l3-3m-3 3l-3-3"
                ></path>
              </svg>
              <span
                id="notificationBadge"
                class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center notification-badge hidden"
                >0</span
              >
            </button>

            <!-- Replay -->
            <button
              id="replayBtn"
              class="p-2 text-gray-600 hover:text-gray-900 transition duration-200"
            >
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
                ></path>
              </svg>
            </button>

            <!-- User Info -->
            <div class="flex items-center space-x-3">
              <div class="text-right">
                <div
                  id="userName"
                  class="text-sm font-medium text-gray-900"
                ></div>
                <div class="text-xs text-gray-500">
                  Score: <span id="userScore" class="font-semibold">0</span>
                </div>
              </div>
              <div
                class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center"
              >
                <span
                  id="userInitial"
                  class="text-white text-sm font-medium"
                ></span>
              </div>
            </div>

            <!-- Logout -->
            <button
              id="logoutBtn"
              class="text-gray-600 hover:text-gray-900 transition duration-200"
            >
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"
                ></path>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="bg-white border-b border-gray-200">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex space-x-8">
          <button
            class="tab-btn py-4 px-1 border-b-2 border-blue-500 text-blue-600 font-medium text-sm"
            data-tab="dashboard"
          >
            Dashboard
          </button>
          <button
            class="tab-btn py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm"
            data-tab="activities"
          >
            Activity Management
          </button>
          <button
            class="tab-btn py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm"
            data-tab="sales-reps"
          >
            Sales Reps
          </button>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <!-- Dashboard Tab -->
      <div id="dashboard" class="tab-content active">
        <div class="mb-6">
          <h2 class="text-2xl font-bold text-gray-900 mb-2">Activity Map</h2>
          <p class="text-gray-600">Real-time view of property activities</p>
        </div>

        <!-- Activity Legend -->
        <div class="bg-white rounded-lg shadow p-4 mb-6">
          <h3 class="text-lg font-medium text-gray-900 mb-3">Activity Types</h3>
          <div class="flex flex-wrap gap-4">
            <div class="flex items-center">
              <div class="activity-marker activity-visit mr-2"></div>
              <span class="text-sm text-gray-700">Visit</span>
            </div>
            <div class="flex items-center">
              <div class="activity-marker activity-call mr-2"></div>
              <span class="text-sm text-gray-700">Call</span>
            </div>
            <div class="flex items-center">
              <div class="activity-marker activity-inspection mr-2"></div>
              <span class="text-sm text-gray-700">Inspection</span>
            </div>
            <div class="flex items-center">
              <div class="activity-marker activity-follow-up mr-2"></div>
              <span class="text-sm text-gray-700">Follow-up</span>
            </div>
            <div class="flex items-center">
              <div class="activity-marker activity-note mr-2"></div>
              <span class="text-sm text-gray-700">Note</span>
            </div>
          </div>
        </div>

        <!-- Map Container -->
        <div class="bg-white rounded-lg shadow">
          <div id="map" class="h-96 rounded-lg"></div>
        </div>
      </div>

      <!-- Activities Tab -->
      <div id="activities" class="tab-content">
        <div class="flex justify-between items-center mb-6">
          <div>
            <h2 class="text-2xl font-bold text-gray-900 mb-2">
              Activity Management
            </h2>
            <p class="text-gray-600">
              Manage and track all property activities
            </p>
          </div>
          <button
            id="addActivityBtn"
            class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-200"
          >
            Add Activity
          </button>
        </div>

        <!-- Filters -->
        <div class="bg-white rounded-lg shadow p-4 mb-6">
          <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <select
              id="filterType"
              class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            >
              <option value="">All Types</option>
              <option value="visit">Visit</option>
              <option value="call">Call</option>
              <option value="inspection">Inspection</option>
              <option value="follow-up">Follow-up</option>
              <option value="note">Note</option>
            </select>
            <select
              id="filterProperty"
              class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            >
              <option value="">All Properties</option>
            </select>
            <select
              id="filterSalesRep"
              class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            >
              <option value="">All Sales Reps</option>
            </select>
          </div>
        </div>

        <!-- Activities Table -->
        <!-- Modal Background -->
        <div
          id="editActivityModal"
          class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden"
        >
          <!-- Modal Box -->
          <div class="bg-white rounded-2xl shadow-lg p-6 w-full max-w-md">
            <h2 class="text-xl font-semibold mb-4 text-center">
              Edit Activity
            </h2>

            <div class="space-y-4">
              <!-- Property Name -->
              <div>
                <label
                  for="editActivityProperty"
                  class="block text-sm font-medium text-gray-700"
                  >Property Name</label
                >
                <select
                  id="editActivityProperty"
                  class="w-full mt-1 p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                ></select>
              </div>

              <!-- Property Type -->
              <div>
                <label
                  for="editActivityType"
                  class="block text-sm font-medium text-gray-700"
                  >Activity Type</label
                >
                <select
                  id="editActivityType"
                  class="w-full mt-1 p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                >
                  <option value="visit">Visit</option>
                  <option value="call">Call</option>
                  <option value="inspection">Inspection</option>
                  <option value="follow-up">Follow-up</option>
                  <option value="note">Note</option>
                </select>
              </div>
            </div>

            <!-- Save Button -->
            <div class="mt-6 flex justify-end">
              <button
                onclick="saveActivityChanges()"
                class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition"
              >
                Save
              </button>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-lg shadow overflow-hidden">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                >
                  Type
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                >
                  Property
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                >
                  Sales Rep
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                >
                  Date
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                >
                  Weight
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                >
                  Actions
                </th>
              </tr>
            </thead>
            <tbody
              id="activitiesTableBody"
              class="bg-white divide-y divide-gray-200"
            >
              <!-- Activities will be populated here -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Sales Reps Tab -->
      <div id="sales-reps" class="tab-content">
        <div class="mb-6">
          <h2 class="text-2xl font-bold text-gray-900 mb-2">
            Sales Representatives
          </h2>
          <p class="text-gray-600">View online and offline sales reps</p>
        </div>

        <!-- Stats Cards -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
          <div class="bg-white rounded-lg shadow p-6">
            <div class="flex items-center">
              <div class="flex-shrink-0">
                <div
                  class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center"
                >
                  <svg
                    class="w-5 h-5 text-white"
                    fill="currentColor"
                    viewBox="0 0 20 20"
                  >
                    <path
                      fill-rule="evenodd"
                      d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                      clip-rule="evenodd"
                    ></path>
                  </svg>
                </div>
              </div>
              <div class="ml-4">
                <p class="text-sm font-medium text-gray-500">Online</p>
                <p
                  id="onlineCount"
                  class="text-2xl font-semibold text-gray-900"
                >
                  0
                </p>
              </div>
            </div>
          </div>

          <div class="bg-white rounded-lg shadow p-6">
            <div class="flex items-center">
              <div class="flex-shrink-0">
                <div
                  class="w-8 h-8 bg-gray-500 rounded-full flex items-center justify-center"
                >
                  <svg
                    class="w-5 h-5 text-white"
                    fill="currentColor"
                    viewBox="0 0 20 20"
                  >
                    <path
                      fill-rule="evenodd"
                      d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"
                      clip-rule="evenodd"
                    ></path>
                  </svg>
                </div>
              </div>
              <div class="ml-4">
                <p class="text-sm font-medium text-gray-500">Offline</p>
                <p
                  id="offlineCount"
                  class="text-2xl font-semibold text-gray-900"
                >
                  0
                </p>
              </div>
            </div>
          </div>

          <div class="bg-white rounded-lg shadow p-6">
            <div class="flex items-center">
              <div class="flex-shrink-0">
                <div
                  class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center"
                >
                  <svg
                    class="w-5 h-5 text-white"
                    fill="currentColor"
                    viewBox="0 0 20 20"
                  >
                    <path
                      d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                    ></path>
                  </svg>
                </div>
              </div>
              <div class="ml-4">
                <p class="text-sm font-medium text-gray-500">Total</p>
                <p id="totalCount" class="text-2xl font-semibold text-gray-900">
                  0
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- Sales Reps List -->
        <div class="bg-white rounded-lg shadow overflow-hidden">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                >
                  Name
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                >
                  Status
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                >
                  Score
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                >
                  Last Online
                </th>
              </tr>
            </thead>
            <tbody
              id="salesRepsTableBody"
              class="bg-white divide-y divide-gray-200"
            >
              <!-- Sales reps will be populated here -->
            </tbody>
          </table>
        </div>
      </div>
    </main>

    <!-- Add Activity Modal -->
    <div
      id="addActivityModal"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden"
    >
      <div class="bg-white rounded-lg p-8 w-96 shadow-xl">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Add New Activity</h2>
        <form id="addActivityForm">
          <div class="mb-4">
            <label class="block text-gray-700 text-sm font-medium mb-2"
              >Property</label
            >
            <select
              id="activityProperty"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              required
            >
              <option value="">Select Property</option>
            </select>
          </div>
          <div class="mb-4">
            <label class="block text-gray-700 text-sm font-medium mb-2"
              >Activity Type</label
            >
            <select
              id="activityType"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              required
            >
              <option value="">Select Type</option>
              <option value="visit">Visit</option>
              <option value="call">Call</option>
              <option value="inspection">Inspection</option>
              <option value="follow-up">Follow-up</option>
              <option value="note">Note</option>
            </select>
          </div>

          <div class="mb-6">
            <label class="block text-gray-700 text-sm font-medium mb-2"
              >Note (Optional)</label
            >
            <textarea
              id="activityNote"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              rows="3"
              placeholder="Add any additional notes..."
            ></textarea>
          </div>
          <div class="flex space-x-4">
            <button
              type="button"
              id="cancelActivityBtn"
              class="flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition duration-200"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition duration-200"
            >
              Add Activity
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Notification Panel -->
    <div
      id="notificationPanel"
      class="fixed top-16 right-4 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-40 hidden"
    >
      <div class="p-4 border-b border-gray-200">
        <h3 class="text-lg font-medium text-gray-900">Notifications</h3>
      </div>
      <div id="notificationList" class="max-h-64 overflow-y-auto">
        <!-- Notifications will be populated here -->
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
